<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deployment | 鲁班H5</title>
    <meta name="description" content="OpenSource Mobile Page Builder&amp;Generator">
    
    
    <link rel="preload" href="/luban-h5/assets/css/0.styles.aa0e875e.css" as="style"><link rel="preload" href="/luban-h5/assets/js/app.8e929c48.js" as="script"><link rel="preload" href="/luban-h5/assets/js/2.e4d215d3.js" as="script"><link rel="preload" href="/luban-h5/assets/js/7.f4a3af6a.js" as="script"><link rel="prefetch" href="/luban-h5/assets/js/10.a133c22b.js"><link rel="prefetch" href="/luban-h5/assets/js/11.08e5987e.js"><link rel="prefetch" href="/luban-h5/assets/js/12.13360ecc.js"><link rel="prefetch" href="/luban-h5/assets/js/13.21160715.js"><link rel="prefetch" href="/luban-h5/assets/js/14.f01217ce.js"><link rel="prefetch" href="/luban-h5/assets/js/15.005fbb0c.js"><link rel="prefetch" href="/luban-h5/assets/js/16.38a1fe01.js"><link rel="prefetch" href="/luban-h5/assets/js/17.003b1273.js"><link rel="prefetch" href="/luban-h5/assets/js/18.5c692040.js"><link rel="prefetch" href="/luban-h5/assets/js/19.4ed0218d.js"><link rel="prefetch" href="/luban-h5/assets/js/20.60da28da.js"><link rel="prefetch" href="/luban-h5/assets/js/21.4c2ed2f6.js"><link rel="prefetch" href="/luban-h5/assets/js/22.bb0f6a5d.js"><link rel="prefetch" href="/luban-h5/assets/js/23.5207f8aa.js"><link rel="prefetch" href="/luban-h5/assets/js/24.114c2788.js"><link rel="prefetch" href="/luban-h5/assets/js/3.a27ab758.js"><link rel="prefetch" href="/luban-h5/assets/js/4.74ff5a30.js"><link rel="prefetch" href="/luban-h5/assets/js/5.3bd60b45.js"><link rel="prefetch" href="/luban-h5/assets/js/6.25b21e13.js"><link rel="prefetch" href="/luban-h5/assets/js/8.b8f34f32.js"><link rel="prefetch" href="/luban-h5/assets/js/9.7d01cdc6.js">
    <link rel="stylesheet" href="/luban-h5/assets/css/0.styles.aa0e875e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/luban-h5/" class="home-link router-link-active"><!----> <span class="site-name">鲁班H5</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://api.luban-h5.wxjcart.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Website
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/ly525/luban-h5/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/luban-h5/en/getting-started/deployment.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/luban-h5/zh/" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/ly525/luban-h5" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://api.luban-h5.wxjcart.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Website
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/ly525/luban-h5/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/luban-h5/en/getting-started/deployment.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/luban-h5/zh/" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/ly525/luban-h5" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>🚀 Getting started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/luban-h5/en/getting-started/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/luban-h5/en/getting-started/features.html" class="sidebar-link">Features</a></li><li><a href="/luban-h5/en/getting-started/quick-start.html" class="sidebar-link">Quick Start</a></li><li><a href="/luban-h5/en/getting-started/deployment.html" class="active sidebar-link">Deployment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/luban-h5/en/getting-started/deployment.html#aliyun-tencent-cloud-digital-ocean" class="sidebar-link">Aliyun/Tencent Cloud/Digital Ocean</a></li><li class="sidebar-sub-header"><a href="/luban-h5/en/getting-started/deployment.html#docker-deployment" class="sidebar-link">Docker deployment</a></li><li class="sidebar-sub-header"><a href="/luban-h5/en/getting-started/deployment.html#heroku" class="sidebar-link">Heroku</a></li></ul></li><li><a href="/luban-h5/en/getting-started/discussion.html" class="sidebar-link">Join Discussion Group</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💡Implementation</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🔌 Local plugins</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="deployment"><a href="#deployment" aria-hidden="true" class="header-anchor">#</a> Deployment</h1> <h2 id="aliyun-tencent-cloud-digital-ocean"><a href="#aliyun-tencent-cloud-digital-ocean" aria-hidden="true" class="header-anchor">#</a> Aliyun/Tencent Cloud/Digital Ocean</h2> <h4 id="_1-on-your-server-centos"><a href="#_1-on-your-server-centos" aria-hidden="true" class="header-anchor">#</a> 1. on your server(centos)</h4> <p>First of all, you need to install some basic software packages, please install them yourself (refer to its official website documents for details)</p> <ol><li>Node</li> <li>Npm</li> <li>Nginx</li> <li>Yarn</li> <li>Pm2</li></ol> <blockquote><p>The following scripts are just for your information</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># install yarn</span>
<span class="token function">curl</span> --silent --location https://dl.yarnpkg.com/rpm/yarn.repo <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/yum.repos.d/yarn.repo
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token function">yarn</span> -y

<span class="token comment"># install nginx</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> nginx -y
<span class="token comment"># install pm2</span>
<span class="token function">npm</span> <span class="token function">install</span> pm2 -g
<span class="token comment"># pm2 examples</span>
<span class="token comment"># pm2 start server.js</span>
<span class="token comment"># pm2 stop server</span>
<span class="token comment"># pm2 restart server</span>
<span class="token comment"># pm2 stop all</span>

</code></pre></div><p>Nginx profile demo</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token keyword">server</span> <span class="token punctuation">{</span>
  <span class="token keyword">listen</span> <span class="token number">443</span><span class="token punctuation">;</span>
  <span class="token keyword">server_name</span> your_domain<span class="token punctuation">;</span>

  <span class="token keyword">client_body_buffer_size</span> <span class="token number">20</span>M<span class="token punctuation">;</span>
  <span class="token keyword">client_max_body_size</span> <span class="token number">20</span>M<span class="token punctuation">;</span>
  <span class="token keyword">proxy_buffer_size</span> <span class="token number">20</span>M<span class="token punctuation">;</span>
  <span class="token keyword">proxy_buffers</span> <span class="token number">32</span> <span class="token number">20</span>M<span class="token punctuation">;</span>
  <span class="token keyword">proxy_busy_buffers_size</span> <span class="token number">20</span>M<span class="token punctuation">;</span>

  <span class="token comment"># https ssl config</span>
  <span class="token keyword">ssl</span> on<span class="token punctuation">;</span>
  <span class="token keyword">ssl_certificate</span> cert<span class="token operator">/</span>your<span class="token operator">-</span><span class="token keyword">https</span><span class="token punctuation">.</span>pem<span class="token punctuation">;</span>
  <span class="token keyword">ssl_certificate_key</span> cert<span class="token operator">/</span>your<span class="token operator">-</span><span class="token keyword">https</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>
  <span class="token keyword">ssl_session_timeout</span> <span class="token number">5</span>s<span class="token punctuation">;</span>
  <span class="token keyword">ssl_ciphers</span> ECDHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES128<span class="token operator">-</span>GCM<span class="token operator">-</span>SHA256<span class="token punctuation">:</span>ECDHE<span class="token punctuation">:</span>ECDH<span class="token punctuation">:</span>AES<span class="token punctuation">:</span>HIGH<span class="token punctuation">:</span><span class="token operator">!</span>NULL<span class="token punctuation">:</span><span class="token operator">!</span>aNULL<span class="token punctuation">:</span><span class="token operator">!</span>MD5<span class="token punctuation">:</span><span class="token operator">!</span>ADH<span class="token punctuation">:</span><span class="token operator">!</span>RC4<span class="token punctuation">;</span>
  <span class="token keyword">ssl_protocols</span> TLSv1 TLSv1<span class="token punctuation">.</span><span class="token number">1</span> TLSv1<span class="token punctuation">.</span><span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>

  <span class="token keyword">gzip</span> on<span class="token punctuation">;</span>
  <span class="token keyword">gzip_min_length</span> <span class="token number">1</span>k<span class="token punctuation">;</span>
  <span class="token keyword">gzip_buffers</span> <span class="token number">4</span> <span class="token number">16</span>k<span class="token punctuation">;</span>
  <span class="token keyword">gzip_disable</span> <span class="token string">&quot;MSIE [1-6]\.&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">gzip_comp_level</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token keyword">gzip_types</span> image<span class="token operator">/</span>png application<span class="token operator">/</span>json text<span class="token operator">/</span>plain application<span class="token operator">/</span>x<span class="token operator">-</span>javascript text<span class="token operator">/</span>css application<span class="token operator">/</span>xml text<span class="token operator">/</span>javascript application<span class="token operator">/</span>javascript<span class="token punctuation">;</span>


  <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">^</span><span class="token operator">/</span><span class="token punctuation">(</span>upload<span class="token operator">|</span>content<span class="token operator">-</span>manager<span class="token operator">|</span>users<span class="token operator">-</span>permissions<span class="token operator">|</span>works<span class="token operator">|</span>admin<span class="token operator">|</span>psd<span class="token operator">-</span>files<span class="token operator">|</span>workforms<span class="token operator">|</span>third<span class="token operator">-</span>libs<span class="token operator">|</span>engine<span class="token operator">-</span>assets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Real<span class="token operator">-</span>IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">1337</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>

    <span class="token keyword">root</span> <span class="token operator">/</span>home<span class="token operator">/</span>centos<span class="token operator">/</span>luban<span class="token operator">-</span>h5<span class="token operator">-</span>dist<span class="token operator">/</span>front<span class="token operator">-</span>end<span class="token operator">/</span><span class="token punctuation">;</span>
    <span class="token comment">#try_files $uri $uri/ /index.html;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-on-local-machine"><a href="#_2-on-local-machine" aria-hidden="true" class="header-anchor">#</a> 2. on local machine</h4> <p>Do the following in the root path of the project:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> flightplan
<span class="token function">npm</span> run deploy:ecs // Elastic Compute Service
</code></pre></div><p>Local deployment script</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> plan <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'flightplan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// configuration</span>
local_dist_dir <span class="token operator">=</span> <span class="token string">'./'</span><span class="token punctuation">;</span> <span class="token comment">// root path for luban-h5</span>
remote_project_dir <span class="token operator">=</span> <span class="token string">'~/codebase/luban/luban-h5'</span><span class="token punctuation">;</span> <span class="token comment">// root path for luban-h5 on server</span>
remote_project_api_dir <span class="token operator">=</span> <span class="token string">'~/codebase/luban/luban-h5/back-end/h5-api'</span><span class="token punctuation">;</span> <span class="token comment">// api root path for luban-h5 on server</span>

<span class="token comment">// production server config</span>
plan<span class="token punctuation">.</span><span class="token function">target</span><span class="token punctuation">(</span><span class="token string">'production'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  host<span class="token punctuation">:</span> <span class="token string">'your host ip'</span><span class="token punctuation">,</span> <span class="token comment">// your server ip</span>
  username<span class="token punctuation">:</span> <span class="token string">'centos'</span><span class="token punctuation">,</span> <span class="token comment">// your server username</span>
  <span class="token comment">// privateKey should be absolute path</span>
  privateKey<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>os<span class="token punctuation">.</span>homedir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/.ssh/id_rsa</span><span class="token template-punctuation string">`</span></span> <span class="token comment">// your privateKey to rsync files</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 1. setup folders
 * 2. sync files
 * 3. install dependencies
 * 4. (re)start api service
 * 5. soft link nginx conf
 *
 */</span>

<span class="token comment">// init remove server path</span>
<span class="token comment">// plan.remote(remote =&gt; {</span>
<span class="token comment">//   // remove.exec(`mkdir -p ${remote_project_dir}`)</span>
<span class="token comment">//   remove.sudo(`yum install nginx -y`)</span>
<span class="token comment">//   remote.with(`mkdir -p ${remote_project_dir}`, () =&gt; {</span>
<span class="token comment">//     // remote.log('Install dependencies');</span>
<span class="token comment">//     // remote.exec('yarn');</span>
<span class="token comment">//     remote.exec('pwd');</span>
<span class="token comment">//   });</span>
<span class="token comment">// });</span>


<span class="token comment">// run commands on localhost</span>
plan<span class="token punctuation">.</span><span class="token function">local</span><span class="token punctuation">(</span><span class="token parameter">local</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// local.log('=&gt; Run build');</span>
  <span class="token comment">// local.exec('npm run build');</span>
  <span class="token comment">// local.log('=&gt; Build finish');</span>

  local<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'=&gt; Copy files to remote hosts'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// TODO reference: https://github.com/pstadler/flightplan/issues/142</span>
  local<span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cd </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>local_dist_dir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// const filesToCopy = local.exec('find . -type f', { silent: true })</span>
    <span class="token keyword">const</span> filesToCopy <span class="token operator">=</span> local<span class="token punctuation">.</span><span class="token function">git</span><span class="token punctuation">(</span><span class="token string">'ls-files'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>silent<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// get list of files under version control</span>

    local<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>filesToCopy<span class="token punctuation">,</span> remote_project_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    local<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'=&gt; Copy finish'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// run commands on the target's remote hosts</span>
plan<span class="token punctuation">.</span><span class="token function">remote</span><span class="token punctuation">(</span><span class="token parameter">remote</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  remote<span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cd </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>remote_project_api_dir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    remote<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Install dependencies'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    remote<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'yarn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    remote<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'pm2 restart server'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="some-problems-that-may-be-encountered-in-the-middle"><a href="#some-problems-that-may-be-encountered-in-the-middle" aria-hidden="true" class="header-anchor">#</a> Some problems that may be encountered in the middle:</h4> <ol><li><code>Cannot parse privateKey: Unsupported key format</code> <br>For solutions, please refer: <a href="https://stackoverflow.com/questions/53400628/cannot-parse-privatekey-unsupported-key-format" target="_blank" rel="noopener noreferrer">Cannot parse privateKey: Unsupported key format<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <h2 id="docker-deployment"><a href="#docker-deployment" aria-hidden="true" class="header-anchor">#</a> Docker deployment</h2> <blockquote><p>TODO</p></blockquote> <h2 id="heroku"><a href="#heroku" aria-hidden="true" class="header-anchor">#</a> Heroku</h2> <blockquote><p>Because Strapi + postgresql still has some pits on Heroku and needs official solution, this solution is temporarily pending.</p></blockquote></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ly525/luban-h5/edit/dev/docs/en/getting-started/deployment.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/14/2019, 9:55:51 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/luban-h5/en/getting-started/quick-start.html" class="prev">Quick Start</a></span> <span class="next"><a href="/luban-h5/en/getting-started/discussion.html">Join Discussion Group</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/luban-h5/assets/js/app.8e929c48.js" defer></script><script src="/luban-h5/assets/js/2.e4d215d3.js" defer></script><script src="/luban-h5/assets/js/7.f4a3af6a.js" defer></script>
  </body>
</html>
